DROP TABLE TURNO CASCADE CONSTRAINTS;
DROP TABLE IES CASCADE CONSTRAINTS;
DROP TABLE CICLO CASCADE CONSTRAINTS;
DROP TABLE OFERTAEDUCATIVA CASCADE CONSTRAINTS;
DROP TABLE ESTUDIANTE CASCADE CONSTRAINTS;
DROP TABLE SOLICITA CASCADE CONSTRAINTS;
DROP TABLE ASIGNACION CASCADE CONSTRAINTS;
CREATE TABLE TURNO(
 IDTURNO NUMBER,
 DESCRIPCION VARCHAR2(15),
 CONSTRAINT PK_TURNO
   PRIMARY KEY(IDTURNO)
)
;
CREATE TABLE IES(
  IDIES NUMBER,
  NOMBRE VARCHAR2(25),
 CONSTRAINT PK_IES
    PRIMARY KEY(IDIES)
)
;
CREATE TABLE CICLO(
  IDCICLO NUMBER,
  NOMBRE VARCHAR2(30),
  GRADO VARCHAR2(15),
  CONSTRAINT PK_CICLO
     PRIMARY KEY(IDCICLO),
  CONSTRAINT CK_GRADOCICLO
  CHECK( GRADO IN ('MEDIO','SUPERIOR'))
)
;
CREATE TABLE OFERTAEDUCATIVA(
 IDIES NUMBER,
 IDCICLO NUMBER,
 IDTURNO NUMBER,
 PLAZAS NUMBER,
 CONSTRAINT PK_OFERTAEDUCATIVA
     PRIMARY KEY(IDIES,IDCICLO,IDTURNO),
 CONSTRAINT FK_OFERTAEDUCATIVA_IES
     FOREIGN KEY(IDIES)REFERENCES IES(IDIES),
 CONSTRAINT FK_OFERTAEDUCATIVA_CICLO
     FOREIGN KEY(IDCICLO)REFERENCES CICLO(IDCICLO),
 CONSTRAINT FK_OFERTAEDUCATIVA_TURNO
    FOREIGN KEY(IDTURNO)REFERENCES TURNO(IDTURNO)
)
;
CREATE TABLE ESTUDIANTE(
  IDESTUDIANTE NUMBER,
  NOMBRE VARCHAR2(25),
  FECHANACIMIENTO DATE,
  IES_DE_PROCEDENCIA NUMBER,
  NOTAMEDIA NUMBER,
  CONSTRAINT PK_ESTUDIANTE
      PRIMARY KEY(IDESTUDIANTE),
  CONSTRAINT FK_EST_CENTROPROCEDENCIA
      FOREIGN KEY(IES_DE_PROCEDENCIA) REFERENCES IES(IDIES)
)
;
CREATE TABLE SOLICITA(
   IDESTUDIANTE NUMBER,
   IDIES NUMBER,
   IDCICLO NUMBER,
   IDTURNO NUMBER,
   PREFERENCIA NUMBER NOT NULL,
   CONSTRAINT PK_SOLICITA
       PRIMARY KEY(IDESTUDIANTE,IDIES,IDCICLO,IDTURNO),
   CONSTRAINT FK_SOLICITA_ESTUDIANTE
       FOREIGN KEY(IDESTUDIANTE) REFERENCES ESTUDIANTE(IDESTUDIANTE),
   CONSTRAINT FK_SOL_CICLOIES
       FOREIGN KEY(IDIES,IDCICLO,IDTURNO) REFERENCES OFERTAEDUCATIVA(IDIES,IDCICLO,IDTURNO),
   CONSTRAINT UQ_PREFERENCIA
       UNIQUE(IDESTUDIANTE,PREFERENCIA),
   CONSTRAINT CK_PREFERENCIA
      CHECK(PREFERENCIA>0 AND PREFERENCIA<7)
)
;
CREATE TABLE ASIGNACION(
   IDESTUDIANTE NUMBER,
   IDIES NUMBER NOT NULL,
   IDCICLO NUMBER NOT NULL,
   IDTURNO NUMBER NOT NULL,
   CONSTRAINT PK_ASIGNACION  
       PRIMARY KEY(IDESTUDIANTE),
  CONSTRAINT FK_ASIG_SOLI
       FOREIGN KEY(IDESTUDIANTE,IDIES,IDCICLO,IDTURNO)
       REFERENCES SOLICITA(IDESTUDIANTE,IDIES,IDCICLO,IDTURNO)
)
;
INSERT INTO TURNO VALUES(1,'DIURNO');
INSERT INTO TURNO VALUES(2,'VESPERTINO');
INSERT INTO IES VALUES(1,'AZARQUIEL');
INSERT INTO IES VALUES(2,'C.E.I.');
INSERT INTO IES VALUES(3,'JUANELO TURRIANO');
INSERT INTO IES VALUES(4,'SEFARAD');
COMMIT;
INSERT INTO CICLO VALUES(1,'DESARROLLO DE APLICACIONES WEB','SUPERIOR');
INSERT INTO CICLO VALUES(2,'ADM.SIST.INFORM','SUPERIOR');
INSERT INTO CICLO VALUES(3,'HOSTELERIA','SUPERIOR');
INSERT INTO CICLO VALUES(4,'PREPARADOR FISICO','SUPERIOR');
INSERT INTO CICLO VALUES(5,'SECRETARIADO','MEDIO');
INSERT INTO CICLO VALUES(6,'ADMINISTRACION Y FINANZAS','SUPERIOR');
INSERT INTO CICLO VALUES(7,'CONSTRUCCION Y OBRA CIVIL','SUPERIOR');
INSERT INTO CICLO VALUES(8,'IMAGEN Y SONIDO','SUPERIOR');
COMMIT;
INSERT INTO OFERTAEDUCATIVA VALUES(1,1,1,3);
INSERT INTO OFERTAEDUCATIVA VALUES(1,1,2,3);
INSERT INTO OFERTAEDUCATIVA VALUES(1,2,1,3);
INSERT INTO OFERTAEDUCATIVA VALUES(1,2,2,4);
INSERT INTO OFERTAEDUCATIVA VALUES(1,6,1,6);
INSERT INTO OFERTAEDUCATIVA VALUES(1,7,1,6);
INSERT INTO OFERTAEDUCATIVA VALUES(2,3,1,3);
INSERT INTO OFERTAEDUCATIVA VALUES(2,6,1,5);
INSERT INTO OFERTAEDUCATIVA VALUES(3,8,1,2);
INSERT INTO OFERTAEDUCATIVA VALUES(3,2,1,8);
INSERT INTO OFERTAEDUCATIVA VALUES(4,4,1,4);

COMMIT;
INSERT INTO ESTUDIANTE VALUES(1,'ESTUDIANTE 1',TO_DATE('10-5-1982','DD-MM-YYYY'),1,5.5);
INSERT INTO ESTUDIANTE VALUES(2,'ESTUDIANTE 2',TO_DATE('11-2-1983','DD-MM-YYYY'),2,6.25);
INSERT INTO ESTUDIANTE VALUES(3,'ESTUDIANTE 3',TO_DATE('9-1-1980','DD-MM-YYYY'),4,7.1);
INSERT INTO ESTUDIANTE VALUES(4,'ESTUDIANTE 4',TO_DATE('15-6-1981','DD-MM-YYYY'),3,8.5);
INSERT INTO ESTUDIANTE VALUES(5,'ESTUDIANTE 5',TO_DATE('16-7-1979','DD-MM-YYYY'),2,5.75);
INSERT INTO ESTUDIANTE VALUES(6,'ESTUDIANTE 6',TO_DATE('10-8-1978','DD-MM-YYYY'),1,6.45);
INSERT INTO ESTUDIANTE VALUES(7,'ESTUDIANTE 7',TO_DATE('1-5-1982','DD-MM-YYYY'),2,8);
INSERT INTO ESTUDIANTE VALUES(8,'ESTUDIANTE 8',TO_DATE('14-9-1980','DD-MM-YYYY'),3,7.5);
INSERT INTO ESTUDIANTE VALUES(9,'ESTUDIANTE 9',TO_DATE('2-2-1984','DD-MM-YYYY'),3,9.5);
INSERT INTO ESTUDIANTE VALUES(10,'ESTUDIANTE 10',TO_DATE('4-5-1980','DD-MM-YYYY'),2,5.15);
INSERT INTO ESTUDIANTE VALUES(11,'ESTUDIANTE 11',TO_DATE('12-12-1980','DD-MM-YYYY'),1,7.85);
INSERT INTO ESTUDIANTE VALUES(12,'ESTUDIANTE 12',TO_DATE('8-2-1983','DD-MM-YYYY'),1,6.15);
INSERT INTO ESTUDIANTE VALUES(13,'ESTUDIANTE 13',TO_DATE('22-6-1983','DD-MM-YYYY'),4,7.35);
INSERT INTO ESTUDIANTE VALUES(14,'ESTUDIANTE 14',TO_DATE('11-9-1981','DD-MM-YYYY'),4,8.9);
INSERT INTO ESTUDIANTE VALUES(15,'ESTUDIANTE 15',TO_DATE('19-3-1977','DD-MM-YYYY'),3,6.9);
INSERT INTO ESTUDIANTE VALUES(16,'ESTUDIANTE 16',TO_DATE('24-1-1982','DD-MM-YYYY'),2,5.9);
INSERT INTO ESTUDIANTE VALUES(17,'ESTUDIANTE 17',TO_DATE('29-5-1979','DD-MM-YYYY'),4,7.65);
INSERT INTO ESTUDIANTE VALUES(18,'ESTUDIANTE 18',TO_DATE('30-9-1974','DD-MM-YYYY'),3,9.35);
INSERT INTO ESTUDIANTE VALUES(19,'ESTUDIANTE 19',TO_DATE('1-4-1980','DD-MM-YYYY'),1,7.8);
INSERT INTO ESTUDIANTE VALUES(20,'ESTUDIANTE 20',TO_DATE('18-7-1976','DD-MM-YYYY'),2,6.6);
INSERT INTO ESTUDIANTE VALUES(21,'ESTUDIANTE 21',TO_DATE('17-5-1976','DD-MM-YYYY'),1,5.6);
INSERT INTO ESTUDIANTE VALUES(22,'ESTUDIANTE 22',TO_DATE('4-8-1969','DD-MM-YYYY'),3,8.45);
INSERT INTO ESTUDIANTE VALUES(23,'ESTUDIANTE 23',TO_DATE('9-2-1981','DD-MM-YYYY'),4,9.65);
INSERT  INTO ESTUDIANTE VALUES(24,'ESTUDIANTE 24',TO_DATE('23-2-1983','DD-MM-YYYY'),4,5.64);
INSERT INTO ESTUDIANTE VALUES(25,'ESTUDIANTE 25',TO_DATE('17-8-1975','DD-MM-YYYY'),1,5.95);
INSERT INTO ESTUDIANTE VALUES(26,'ESTUDIANTE 26',TO_DATE('14-7-1980','DD-MM-YYYY'),1,6.68);
INSERT INTO ESTUDIANTE VALUES(27,'ESTUDIANTE 27',TO_DATE('11-2-1982','DD-MM-YYYY'),2,7.05);
INSERT INTO ESTUDIANTE VALUES(28,'ESTUDIANTE 28',TO_DATE('9-5-1981','DD-MM-YYYY'),4,5.85);
COMMIT;
INSERT INTO SOLICITA VALUES(1,1,1,1,1);
INSERT INTO SOLICITA VALUES(1,1,1,2,2);
INSERT INTO SOLICITA VALUES(2,1,1,1,1);
INSERT INTO SOLICITA VALUES(2,1,1,2,2);
INSERT INTO SOLICITA VALUES(3,4,4,1,1);
INSERT INTO SOLICITA VALUES(3,3,8,1,2);
INSERT INTO SOLICITA VALUES(4,1,1,1,1);
INSERT INTO SOLICITA VALUES(4,1,1,2,2);
INSERT INTO SOLICITA VALUES(5,4,4,1,1);
INSERT INTO SOLICITA VALUES(5,1,1,1,2);
INSERT INTO SOLICITA VALUES(6,1,1,1,1);
INSERT INTO SOLICITA VALUES(6,1,2,2,2);
INSERT INTO SOLICITA VALUES(7,4,4,1,1);
INSERT INTO SOLICITA VALUES(7,1,1,1,2);
INSERT INTO SOLICITA VALUES(8,2,3,1,1);
INSERT INTO SOLICITA VALUES(8,2,6,1,2);
INSERT INTO SOLICITA VALUES(9,1,1,1,1);
INSERT INTO SOLICITA VALUES(9,1,1,2,2);
INSERT INTO SOLICITA VALUES(10,2,3,1,1);
INSERT INTO SOLICITA VALUES(11,2,6,1,1);
INSERT INTO SOLICITA VALUES(11,2,3,1,2);
INSERT INTO SOLICITA VALUES(12,1,1,1,1);
INSERT INTO SOLICITA VALUES(12,1,1,2,2);
INSERT INTO SOLICITA VALUES(13,3,8,1,1);
INSERT INTO SOLICITA VALUES(13,4,4,1,2);
INSERT INTO SOLICITA VALUES(14,1,1,1,1);
INSERT INTO SOLICITA VALUES(15,1,7,1,1);
INSERT INTO SOLICITA VALUES(15,1,2,2,2);
INSERT INTO SOLICITA VALUES(16,1,7,1,1);
INSERT INTO SOLICITA VALUES(16,1,2,2,2);
INSERT INTO SOLICITA VALUES(17,3,8,1,1);
INSERT INTO SOLICITA VALUES(17,2,6,1,2);
INSERT INTO SOLICITA VALUES(18,1,7,1,1);
INSERT INTO SOLICITA VALUES(19,1,1,1,1);
INSERT INTO SOLICITA VALUES(19,1,7,1,2);
INSERT INTO SOLICITA VALUES(20,3,8,1,1);
INSERT INTO SOLICITA VALUES(21,2,6,1,1);
INSERT INTO SOLICITA VALUES(22,1,1,2,1);
INSERT INTO SOLICITA VALUES(23,1,1,1,1);
INSERT INTO SOLICITA VALUES(24,4,4,1,1);
INSERT INTO SOLICITA VALUES(24,2,3,1,2);
INSERT INTO SOLICITA VALUES(25,4,4,1,1);
INSERT INTO SOLICITA VALUES(25,2,3,1,2);
INSERT INTO SOLICITA VALUES(26,4,4,1,1);
INSERT INTO SOLICITA VALUES(26,3,8,1,2);
INSERT INTO SOLICITA VALUES(27,4,4,1,1);
INSERT INTO SOLICITA VALUES(27,3,8,1,2);
INSERT INTO SOLICITA VALUES(28,3,8,1,1);
INSERT INTO SOLICITA VALUES(28,1,2,1,2);
INSERT INTO SOLICITA VALUES(28,1,2,2,3);

INSERT INTO ASIGNACION VALUES(18,1,7,1);
INSERT INTO ASIGNACION VALUES(14,1,1,1);
INSERT INTO ASIGNACION VALUES(4,1,1,2);
INSERT INTO ASIGNACION VALUES(22,1,1,2);
INSERT INTO ASIGNACION VALUES(7,4,4,1);
INSERT INTO ASIGNACION VALUES(11,2,6,1);
INSERT INTO ASIGNACION VALUES(19,1,7,1);
INSERT INTO ASIGNACION VALUES(17,3,8,1);
INSERT INTO ASIGNACION VALUES(8,2,3,1);
INSERT INTO ASIGNACION VALUES(13,3,8,1);
INSERT INTO ASIGNACION VALUES(3,4,4,1);
INSERT INTO ASIGNACION VALUES(27,4,4,1);
INSERT INTO ASIGNACION VALUES(15,1,7,1);
INSERT INTO ASIGNACION VALUES(26,4,4,1);
INSERT INTO ASIGNACION VALUES(6,1,2,2);
INSERT INTO ASIGNACION VALUES(2,1,1,2);
INSERT INTO ASIGNACION VALUES(25,2,3,1);
INSERT INTO ASIGNACION VALUES(16,1,7,1);
INSERT INTO ASIGNACION VALUES(28,1,2,1);
INSERT INTO ASIGNACION VALUES(24,2,3,1);
INSERT INTO ASIGNACION VALUES(21,2,6,1);
INSERT INTO ASIGNACION VALUES(23,1,1,1);
INSERT INTO ASIGNACION VALUES(9,1,1,1);

COMMIT;
